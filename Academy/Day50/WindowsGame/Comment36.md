## 게임 이벤트 패턴

### 이벤트

```
블랙프라이데이 이벤트
할로윈 이벤트


이런거 아닙니다.
```

```
 이벤트가 뭐냐면
  구독개념

 
 Publish / Subscribe 개념

 Pub/Sub

 이게 무엇인가?

 특정 주제를 갖고 이거를 구독했다가 실행하는 개념.
 [캐릭터가 데미지를 맞았다.] (미사일클래스에서 발생.)
  => DamageUI가 발생함.  (UI시스템쪽 코드)
  => 실질적으로 캐릭터의 HP가 까짐. (캐릭터 컨트롤러쪽 코드)
  => 딜미터기에 기록이 된다. (딜미터기 관련 클래스 코드)
  => 특정 CC에 맞았으면 시스템채팅이 발생한다. (채팅 관련 코드)

 그러면 미사일 코드에서 
	 UI시스템도 불러오고
	 캐릭터 컨트롤러도 불러오고
	 딜미터기도 불러오고
	 채팅 관련 코드도 불러와야하나?

 => 짬뽕 코드, 스파케티 코드 

 [보스가 등장했다.] (보스클래스코드)
	=> 이펙트가 발생 (보스클래스코드)
	=> UI가 보스 전용 UI로 전환 (UI 클래스코드)
	=> 시스템 채팅이 나온다. (채팅관련 코드)
	=> 필드효과가 변한다. (필드관련 코드)

```

## **참고할내용.**
```
 Pub/Sub 왜 굳이 나중에 가르치는건가.

 이게 안중요해요.
 (취업할때.)

 신입한테거는 기대가 그렇게 안커요.

 제가 봤을때는 별거없는 기술인데
 3-5년차부터 이거를 제대로 다룬다고 생각을 하기 떄문에
```

## Pub / Sub
```
 주제들을 Publish하는 것.

 주제들을 정해야겠죠? (enum으로.)
	[캐릭터가 죽었다.]
	[게임이 시작했다.]
	[보스가 등장했다.]
	// 등등.. 
	(1000가지)

 각 객체에서 초기화할때 주제들을 Subscribe (구독) 합니다.
  - 시스템채팅 관련코드 Init에서 
	- [캐릭터가 죽었다.] 이벤트
	- [게임이 시작했다.]
	- [보스가 등장했다.]
	- [환경기후가 변했다.]

 이벤트구독을하고, (Subscribe)
 이벤트가 발생하면 (Publish)
 어떤함수로 넘겨줄지까지 CallbackFunction을 연동한다.
```


## Pub/Sub의 장점과 단점
```
 장점 - 약한 결합을 합니다.
 단점 - 어떻게보면 가독성이 떨어집니다.
	

ex. 캐릭터 컨트롤러
 if(_hp <= 0)
 {
	GameEvent.Publish(EGameEvent.PlayerDied);
	//_retryPanel.SetInfo( 플레이시간, 딜측정기, );
	//_retryPanel.Show();
 }
  => 이게 가독성이 좋아보일수있는데,
     유지보수할때 찾아야하는 내용은
	 캐릭터가 죽었을때 Retry창이 떠야하는데 안떠요.

  => 모든부분에서 Pub/Sub을 쓰게되면, 버그를 마주할때마다 피로감이 좀 높아요.
     하지만 그만큼 유지보수성에서는 많은 이득을 보게됩니다.





 ※ 결합이란?
  - 코드의 연관성
  - Day35Scene을 구성하기위해서, Day35Scene.h Day35Scene.cpp 를 가지고 완전다른 프로젝트에 가져가면
  문제가 생기져?
	- GameResultPanel도 있고
	  GameResultPanel안에는 여러가지 UI가 결합 되어있습니다.
	- 그래서 Day35Scene을 가져가기 위해서는 다른 모든 코드를 가져가야하는 문제가 발생함.
	(이게 강한 결합)

  - SoundManager만 가져갈래요.
   (이거정도는 ResourceManager빼고는 결합이 안되어있습니다.)

  - 웬만해서는 클래스끼리 결합을 안시키는게 좋다고 정평이 나있어요.

  - 그럼에도 불구하고 게임쪽은 결합이 되어있어야 이득보는게 너무많기때문에
    게임쪽에선 그렇지않아요.


 ※ 결합이 왜 안좋나요?
  - UI 관련을 수정하려고하는데
    수정해야하는 코드가 UI만 수정할게아니라
	씬도수정해야하고
	캐릭터도 수정해야하고
	배경도 수정해야하고
	관련 시스템코드도 수정해야하면
	혹은 매니저까지 수정해야하면
	이거는 기존작업자아니면 수정을 못하는 코드가 됩니다.

	결합을 최소한으로 해주는게 유지보수 측면에서 많이 유용합니다.

```


```
그래서 지금부터할거는

Pub/Sub 구조를 활용해서 게임이벤트 매니저를 만들겁니다.

제가 만든 프레임워크에서는 대부분이 게임엔진에 있는 기능이지만
없는 것도 꽤많습니다.

없는 거는 보통 게임회사에서 각자 구현합니다.

이 없는 부분에 대해서는 게임회사에서 이 지식을 알면 되게 좋아해요.

```



#### 공지사항

```
Pub/Sub 구조를 알아봤고,

여러분들 지금까지 배운내용으로 포트폴리오 만들어주시면되는데,
어 나는 Windows API 포트폴리오 만들기 싫다. 시간낭비인거같다.

여러분들이 여태까지 배운 지식으로 가장 쉽게 기술력을 테스트해볼수있는 곳은 WindowsAPI에요

엔진으로 지금 배운 내용들 다 활용하려면
엔진 1년은 배워야합니다.

영상설명이나
포트폴리오에 쓸만한 내용을 많이 구현할수있거든요.

기술력을 증명할수있는 가장 쉬운 포트폴리오입니다.

그리고
포트폴리오
1달드릴거에요.

데이터쪽은 안다루긴했는데
데이터는 그냥 하드코딩해주시면돼요.
Enums나 Defines에 하드코딩
아니면Constants라고 만들어서.


포트폴리오 만드는도중에
이런기능은 어떻게 구현하나요
이런거 하고싶은데 어떻게 해야할지 모르겠어요.
이런거 질문있으면 편하게 질문해주세요.
방금 만든 GameEventManager를 여기서 활용하고싶은데 모르겠다.



1달 반동안은
C# + 코딩테스트 준비
Day36 ~ 50 

제출한사람이 있다.
여러명이면 => 빠르게 코드리뷰하면서 다봐드릴거고
한명이면 => 시간에맞게 코드리뷰하면서 수정
없으면 => Direct3D 렌더링파이프라인

 + 포트폴리오 없으면 취업안되나요?
   => 안됩니다.
 
 + 엔진포폴만 갖고 취업안되나요?
   => 돼요.
```